# in class example

print(ToothGrowth)
dataset <- data.frame(ToothGrowth)

print(dataset)

attach(dataset)

# Variance test

# to find docs of a function: ?[function name]

# var.test(response ~ groups, data, alternative = "two-sided")
var.test(len ~ supp, dataset, alternative = "two.sided")
var.test(len ~ supp, dataset, alternative = "two.sided", conf.level = 0.99)


# histogram of len
hist(len)


# Shapiro test for normality

# H_0: Variable is normally distributed
# H_A: Variable is not normally distributed
# if p-val > .05, the assumption is satisfied
shapiro.test(len)

  # Output:
# Shapiro-Wilk normality test

# data:  len
# W = 0.96743, p-value = 0.1091
# p-val is < .05, fail to reject H_0

              # ANOVAS

# results <- aov(response ~ group, data = dataset)
results_oneway <- aov(len ~ supp, data = dataset)
summary(results_oneway)

# Blocking
# results <- aov(response ~ group + block, data = dataset)
results_block <- aov(len ~ supp + as.factor(dose), data = dataset)
summary(results_block)

# Two-way ANOVA
# results <- aov(response ~ group1 + group2 + group1 * group2, data = dataset)
results_twoway <- aov(len ~ supp + as.factor(dose) + supp*as.factor(dose), data = dataset)
summary(results_twoway)

f_stat = ((205.4+2426.4+108.3) / 13.2)
print(f_stat)
# pf(test_statistic, dfnum, dfdem, lower.tail = FALSE)
pf(f_stat, 5, 54, lower.tail = FALSE)

# Post-hoc

# Tukey
TukeyHSD(results_twoway)
plot(TukeyHSD(results_twoway))

# note to self: how to pop out plot into another window:
# > dev.new()
# > plot(data)


# Bonf
pairwise.t.test(len, as.factor(dose), method = "bonf")
